!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=9007199254740991,n="[object Arguments]",o="[object Function]",r="[object GeneratorFunction]",i=/^(?:0|[1-9]\d*)$/;function a(e,t){for(var n=-1,o=e?e.length:0;++n<o&&!1!==t(e[n],n,e););return e}var c,l,s=Object.prototype,d=s.hasOwnProperty,u=s.toString,f=s.propertyIsEnumerable,p=(c=Object.keys,l=Object,function(e){return c(l(e))});function h(e,t){var o=T(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&j(e)}(e)&&d.call(e,"callee")&&(!f.call(e,"callee")||u.call(e)==n)}(e)?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],r=o.length,i=!!r;for(var a in e)!t&&!d.call(e,a)||i&&("length"==a||g(a,r))||o.push(a);return o}var m,y,v=(m=function(e,t){return e&&b(e,t,O)},function(e,t){if(null==e)return e;if(!j(e))return m(e,t);for(var n=e.length,o=y?n:-1,r=Object(e);(y?o--:++o<n)&&!1!==t(r[o],o,r););return e}),b=function(e){return function(t,n,o){for(var r=-1,i=Object(t),a=o(t),c=a.length;c--;){var l=a[e?c:++r];if(!1===n(i[l],l,i))break}return t}}();function w(e){if(n=(t=e)&&t.constructor,o="function"==typeof n&&n.prototype||s,t!==o)return p(e);var t,n,o,r=[];for(var i in Object(e))d.call(e,i)&&"constructor"!=i&&r.push(i);return r}function g(e,n){return!!(n=null==n?t:n)&&("number"==typeof e||i.test(e))&&e>-1&&e%1==0&&e<n}var T=Array.isArray;function j(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?u.call(e):"";return t==o||t==r}(e)}function O(e){return j(e)?h(e):w(e)}function k(e){return e}var C=function(e,t){return(T(e)?a:v)(e,"function"==typeof t?t:k)};const I=e=>{if(!document.body.contains(e))return!1;const t=e.getBoundingClientRect();return t.top<=window.innerHeight&&t.top+t.height>=0&&t.left<=window.innerWidth&&t.left+t.width>=0},A=/^(https:\/\/[^/]*?)\/b\/([a-zA-Z0-9]{8,24})/,E=/^(https:\/\/[^/]*?)\/c\/([a-zA-Z0-9]{8,24})/,N=e=>/^[a-f0-9]{24}$/.test(e)||/^[a-zA-Z0-9]{8}$/.test(e),K=(e,t,n,o)=>{e&&e.contentWindow&&e.contentWindow.postMessage({secret:n,command:"polling",options:{enabled:o}},t)};class ${constructor(){this.version="BUILD_VERSION","complete"===document.readyState?this.load():window.addEventListener("load",(()=>this.load()))}createBoardIframe(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=document.createElement("iframe"),a=encodeURIComponent(window.location.origin),c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",l=Array(24).join().split(",").map((()=>c.charAt(Math.floor(Math.random()*c.length)))).join("");if(i.src=e+"/embed/board?"+`id=${t}&targetOrigin=${a}&secret=${l}&compact=${!0===o}`,i.width=248,i.height=o?185:218,i.style.border="none",i.style.overflow="hidden",i.className="trello-board trello-board-rendered",o&&i.classList.add("trello-board-compact"),r&&r.apiToken&&r.apiKey){const{apiKey:e,apiToken:t}=r;i.name=JSON.stringify({apiKey:e,apiToken:t})}return i}create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{apiKey:o,apiToken:r}=n;let i="https://trello.com",a=e;if(A.test(a)){const e=A.exec(a);if(!e||!e[1]||!e[2])throw new Error("Invalid Trello board url");[,i,a]=e}if(!N(a))throw new Error("Invalid Trello board id");const c=this.createBoardIframe(i,a,"Trello Board",!0,{apiKey:o,apiToken:r});t.appendChild(c)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allAnchors:!1};const{allAnchors:n,apiKey:o,apiToken:r}=t,i=n?"a":"blockquote.trello-board-compact>a",a=(e||document).querySelectorAll(i);C(a,(e=>{const{href:t}=e,i=A.exec(t);if(!i||!i[1]||!i[2])return;const a=i[1],c=i[2],l=e.innerText,s=this.createBoardIframe(a,c,l,!0,{apiKey:o,apiToken:r});if(n)e.parentNode.replaceChild(s,e);else{const t=e.parentNode;t.parentNode.replaceChild(s,t)}}))}}var L=/^\s+|\s+$/g,S=/^[-+]0x[0-9a-f]+$/i,x=/^0b[01]+$/i,z=/^0o[0-7]+$/i,B=parseInt,R="object"==typeof e&&e&&e.Object===Object&&e,M="object"==typeof self&&self&&self.Object===Object&&self,q=R||M||Function("return this")(),V=Object.prototype.toString,W=Math.max,U=Math.min,D=function(){return q.Date.now()};function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Z(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==V.call(e)}(e))return NaN;if(F(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=F(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(L,"");var n=x.test(e);return n||z.test(e)?B(e.slice(2),n?2:8):S.test(e)?NaN:+e}var J=function(e,t,n){var o,r,i,a,c,l,s=0,d=!1,u=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=o,i=r;return o=r=void 0,s=t,a=e.apply(i,n)}function h(e){return s=e,c=setTimeout(y,t),d?p(e):a}function m(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-s>=i}function y(){var e=D();if(m(e))return v(e);c=setTimeout(y,function(e){var n=t-(e-l);return u?U(n,i-(e-s)):n}(e))}function v(e){return c=void 0,f&&o?p(e):(o=r=void 0,a)}function b(){var e=D(),n=m(e);if(o=arguments,r=this,l=e,n){if(void 0===c)return h(l);if(u)return c=setTimeout(y,t),p(l)}return void 0===c&&(c=setTimeout(y,t)),a}return t=Z(t)||0,F(n)&&(d=!!n.leading,i=(u="maxWait"in n)?W(Z(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f),b.cancel=function(){void 0!==c&&clearTimeout(c),s=0,o=l=r=c=void 0},b.flush=function(){return void 0===c?a:v(D())},b};class G{constructor(){this.version="BUILD_VERSION",this.activeCards={};window.addEventListener("message",(e=>{var t;if((t=e.origin,/^https:\/\/trell(?:o\.com|is\.coffee)$/.test(t))&&("resize"===e.data.command&&e.data.secret)){const t=this.activeCards[e.data.secret];if(!t||!t.el)return;const n=e.data.options.height;void 0!==n&&(t.el.height=n,"function"==typeof this.onResize&&this.onResize({height:e.data.options.height,width:parseInt(t.el.width,10)})),K(t.el,e.origin,e.data.secret,I(t.el))}}),!1),window.addEventListener("resize",J((()=>this.reassessVisibility()),1e3)),window.addEventListener("scroll",J((()=>this.reassessVisibility()),1e3)),"complete"===document.readyState?this.load():window.addEventListener("load",(()=>this.load()))}reassessVisibility(){C(this.activeCards,((e,t)=>{const{el:n,host:o}=e;document.body.contains(n)&&K(n,o,t,I(n))}))}createCardIframe(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=document.createElement("iframe"),a=encodeURIComponent(window.location.origin),c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",l=Array(24).join().split(",").map((()=>c.charAt(Math.floor(Math.random()*c.length)))).join("");if(i.src=e+"/embed/card?"+`id=${t}&targetOrigin=${a}&secret=${l}&compact=${!0===o}`,i.width=316,i.height=152,i.style.border="none",i.style.overflow="hidden",i.className="trello-card trello-card-rendered",o&&i.classList.add("trello-card-compact"),r&&r.apiToken&&r.apiKey){const{apiKey:e,apiToken:t}=r;i.name=JSON.stringify({apiKey:e,apiToken:t})}return i.onload=r.onLoad,this.activeCards[l]={el:i,host:e},i}create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{compact:!1};const{compact:o,apiKey:r,apiToken:i,onLoad:a,onResize:c}=n;let l="https://trello.com",s=e;if(E.test(s)){const e=E.exec(s);if(!e||!e[1]||!e[2])throw new Error("Invalid Trello card url");[,l,s]=e}if(!N(s))throw new Error("Invalid Trello card id");this.onResize=c;const d=this.createCardIframe(l,s,"Trello Card",o,{apiKey:r,apiToken:i,onLoad:a});t.appendChild(d)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{compact:!1,allAnchors:!1};const{allAnchors:n,compact:o,apiToken:r,apiKey:i}=t,a=n?"a":"blockquote.trello-card>a, blockquote.trello-card-compact>a",c=(e||document).querySelectorAll(a);C(c,(e=>{const{href:t}=e,a=E.exec(t);if(!a||!a[1]||!a[2])return;const c=a[1],l=a[2],s=e.innerText,d=!0===o||e.parentElement.classList.contains("trello-card-compact"),u=this.createCardIframe(c,l,s,d,{apiKey:i,apiToken:r});if(n)e.parentNode.replaceChild(u,e);else{const t=e.parentNode;t.parentNode.replaceChild(u,t)}}))}}window.TrelloCards||(window.TrelloCards=new G),window.TrelloBoards||(window.TrelloBoards=new $)}));
//# sourceMappingURL=embed.min.js.map
